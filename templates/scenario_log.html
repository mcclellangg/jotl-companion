<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encounter Tracking Table</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chota/0.8.0/chota.min.css">
    <style>
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1rem;
        }

        .number-cell {
            text-align: right;
        }

        .notes-cell {
            max-width: 300px;
            word-wrap: break-word;
        }

        .footer-row {
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .add-scenario-btn {
            margin: 1rem 0;
            width: 100%;
        }

        .editable {
            border: none;
            background: transparent;
            width: 100%;
            padding: 0.25rem;
        }

        .editable:focus {
            background: white;
            border: 1px solid #007bff;
            outline: none;
        }

        tbody tr:nth-child(3n+1) {
            border-top: 2px solid #007bff;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="text-center">Encounter Tracking</h1>

        <table class="striped">
            <thead>
                <tr>
                    <th>Encounter</th>
                    <th>XP</th>
                    <th>Gold</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Initial scenario -->
                <tr>
                    <td>Encounter</td>
                    <td class="number-cell"><input type="text" class="editable xp-input" value="0"></td>
                    <td class="number-cell"><input type="text" class="editable gold-input" value="0"></td>
                    <td class="notes-cell"><input type="text" class="editable" placeholder="Notes..."></td>
                </tr>
                <tr>
                    <td>Event</td>
                    <td class="number-cell"><input type="text" class="editable xp-input" value="0"></td>
                    <td class="number-cell"><input type="text" class="editable gold-input" value="0"></td>
                    <td class="notes-cell"><input type="text" class="editable" placeholder="Notes..."></td>
                </tr>
                <tr>
                    <td>Shop</td>
                    <td class="number-cell"><input type="text" class="editable xp-input" value="0"></td>
                    <td class="number-cell"><input type="text" class="editable gold-input" value="0"></td>
                    <td class="notes-cell"><input type="text" class="editable" placeholder="Notes..."></td>
                </tr>
            </tbody>
            <tfoot>
                <tr class="footer-row">
                    <td><strong>Totals</strong></td>
                    <td class="number-cell"><strong id="totalXp">0</strong></td>
                    <td class="number-cell"><strong id="totalGold">0</strong></td>
                    <td></td>
                </tr>
            </tfoot>
        </table>

        <button class="button primary add-scenario-btn" onclick="addScenario()">
            + Add New Scenario
        </button>
    </div>

    <script>
        function addScenario() {
            const tableBody = document.getElementById('tableBody');

            // Create the three rows for a new scenario
            const scenarioRows = [
                { type: 'Encounter' },
                { type: 'Event' },
                { type: 'Shop' }
            ];

            scenarioRows.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.type}</td>
                    <td class="number-cell"><input type="text" class="editable xp-input" value="0"></td>
                    <td class="number-cell"><input type="text" class="editable gold-input" value="0"></td>
                    <td class="notes-cell"><input type="text" class="editable" placeholder="Notes..."></td>
                `;
                tableBody.appendChild(tr);
            });

            // Add event listeners to the new inputs
            addEventListeners();
        }

        function calculateTotals() {
            const xpInputs = document.querySelectorAll('.xp-input');
            const goldInputs = document.querySelectorAll('.gold-input');

            let totalXp = 0;
            let totalGold = 0;

            xpInputs.forEach(input => {
                const value = parseInt(input.value) || 0;
                totalXp += value;
            });

            goldInputs.forEach(input => {
                const value = parseInt(input.value) || 0;
                totalGold += value;
            });

            document.getElementById('totalXp').textContent = totalXp;
            document.getElementById('totalGold').textContent = totalGold;
        }

        function addEventListeners() {
            // Add event listeners to all XP and Gold inputs
            const inputs = document.querySelectorAll('.xp-input, .gold-input');
            inputs.forEach(input => {
                input.removeEventListener('input', calculateTotals); // Prevent duplicate listeners
                input.addEventListener('input', calculateTotals);
            });
        }

        // Initialize event listeners and calculate initial totals
        document.addEventListener('DOMContentLoaded', function () {
            addEventListeners();
            calculateTotals();
        });

        // Export functionality (for future use)
        function exportData() {
            const rows = document.querySelectorAll('#tableBody tr');
            const data = [];

            rows.forEach((row, index) => {
                const cells = row.querySelectorAll('td');
                const encounterType = cells[0].textContent;
                const xp = cells[1].querySelector('input').value;
                const gold = cells[2].querySelector('input').value;
                const notes = cells[3].querySelector('input').value;

                data.push({
                    scenario: Math.floor(index / 3) + 1,
                    type: encounterType,
                    xp: parseInt(xp) || 0,
                    gold: parseInt(gold) || 0,
                    notes: notes
                });
            });

            return JSON.stringify(data, null, 2);
        }
    </script>
</body>

</html>